;==============================================================================================
;文件名：	SYSTEM_DEBUG_Maid.ERB
;版本：		Ver.1.12_21/02/13
;原作者：	Tsubasa
;原文件:		SYSTEM_DEBUG_Universal_eraTW.ERB
;作者：		likulisu
;參考:		[star],[LJ],[112233]
;啟動用函式：@DEBUG_Maid
;使用例子：
;   ELSEIF RESULT == 9988
;       CALL DEBUG_Maid
;==============================================================================================
;---------------------------------------------資訊---------------------------------------------
;取自於ERA用之於ERA，通知一下歡迎搬運魔改
;想加的項目 更多修改模式,增加溫度
;想改的項目 全通用變數改成自訂變數(RESULT:90-4[數值修改值] 81顯示數量)
;
;v1,12(21/02/13)
;  角色選擇頁錯誤修改
;v1.11(21/02/08)
;  部分函式更名
;v1.1(21/02/07)
; 部分通用變數變成自訂、　增加DEBUG自用存檔、　主畫面的女僕碎念、　記住最後選擇對象
;==============================================================================================
;-------------------------------------------主選單---------------------------------------------
;==============================================================================================
@DEBUG_MENU_U
#DIM CLINE
    RESULT:81 = 100
    REPEAT 50
        PRINTL
    REND
    RESULT = GET_CLINE(0)
    GETTIME
    SAVEDATA 991, RESULTS + " " + @"{DAY}日目 DEBUG修改前"
    CALL DEBUG_myMaid(0,TARGET,DAY)

@DEBUG_myMaid(TARGET,oldTARGET,oldDAY)
#DIM oldDAY
#DIM oldTARGET
#DIM menuFLAG,10
#DIM myMODE
#DIM myPAGE
#DIMS mySAVE,3
myPAGE = MY_PAGE(0,0)
$PRINT_LIST
myMODE = NXP_MODE(1,0,0)
CLEARLINE LINECOUNT-GET_CLINE(1)
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORML %GAMEBASE_TITLE%　Ver.{GAMEBASE_VERSION}
PRINTFORML ＤＥＢＵＧＭＯＤＥ　Ver.1.12
ALIGNMENT LEFT
DRAWLINEFORM =
PRINTFORM %"　"%\@(oldDAY != DAY) ? 經過{DAY}天＊注意天數被修改(原{oldDAY}天)＊ # 經過{DAY}天\@
PRINTFORML %"　時間:"%{TIME:LOCAL/60}時{TIME:LOCAL-(TIME:LOCAL/60)*60}分({TIME:LOCAL}分)
PRINTFORML 　親愛的MASTER，請問您要準備做什麼？(持有{MONEY}元)
DRAWLINE
PRINTBUTTON  \@(!menuFLAG:1) ? ⊞ 基本操作 ⊞ # ⊟ 基本操作 ⊟\@,1101
PRINTL
IF menuFLAG:1
    PRINTLC [101] - 角色全回復
    PRINTLC [102] - ITEM編輯
    PRINTLC [103] - 修改金錢
ENDIF
PRINTL
PRINTBUTTON \@(!menuFLAG:2) ? ⊞ 事件操作  ⊞ # ⊟ 事件操作  ⊟\@,1102
PRINTL
IF menuFLAG:2
    PRINTLC [104] - FLAG操作
    PRINTLC [105] - TFLAG編輯
ENDIF
PRINTL
PRINTBUTTON \@(!menuFLAG:3) ? ⊞ 時間操作（慎用！） ⊞ # ⊟ 時間操作（慎用！） ⊟\@,1103
PRINTL
IF menuFLAG:3
    PRINTLC [191] - TIME編輯
    PRINTLC [198] - 日期編輯
    PRINTLC [199] - 跳至下一天
ENDIF
PRINTL
PRINTBUTTON \@(!menuFLAG:4) ? ⊞ DEBUG用存檔（僅讀取） ⊞ # ⊟ DEBUG用存檔（僅讀取） ⊟\@,1104
PRINTL
IF menuFLAG:4
    PRINTFORMLC [991] - {DAY}日_修改前
    PRINTFORMLC [992] - %mySAVE:1%
    PRINTFORMLC [993] - %mySAVE:2%
ENDIF
PRINTL
DRAWLINE
CALL NXP_BCHARAR(1)
PRINTBUTTON \@(!menuFLAG:6) ? ⊟ 數值編輯 ⊟ # ⊞ 數值編輯 ⊞\@,1106
PRINTL
IF !menuFLAG:6
    PRINTLC [201] - 能力編輯(ABL)
    PRINTLC [202] - 經驗編輯(EXP)
    PRINTLC [203] - 素質編輯(TALENT)
    PRINTLC [204] - 刻印編輯(MARK)
    PRINTL
    PRINTLC [205] - 珠編輯(JUEL)
    PRINTLC [206] - 體質編輯(BASE)
    PRINTLC [207] - 裝備編輯(EQUIP)
    PRINTLC [208] - 裝備編輯(TEQUIP)
    PRINTL
    PRINTLC [209] - 狀態編輯(PALAM)
    PRINTLC [210] - 絕頂編輯(EX)
    PRINTLC [211] - SOURCE編輯
    PRINTLC [212] - 角色事件(CFLAG)
ENDIF
PRINTL
PRINTBUTTON \@(!menuFLAG:7) ? ⊞ 文字編輯 ⊞ # ⊟ 文字編輯 ⊟\@,1107
PRINTL
IF menuFLAG:7
    PRINTLC [301] - CSTR編輯
    PRINTLC [302] - TSTR編輯
    PRINTLC [303] - STR編輯
;   PRINTLC [---] -
ENDIF
PRINTL
PRINTBUTTON \@(!menuFLAG:8) ? ⊞ 其他項目 ⊞ # ⊟ 其他項目 ⊟\@,1108
PRINTL
IF menuFLAG:8
    PRINTLC [401] - 角色管理
    PRINTLC [402] - 指令名展示(TRAIN)
    PRINTLC [403] - RELATION編輯
    PRINTLC [---] -
    PRINTL
    PRINTLC [405] - TCVAR編輯
    PRINTLC [406] - STAIN編輯
    PRINTLC [407] - GOTJUEL編輯
    PRINTLC [408] - NOWEX編輯
ENDIF
PRINTL
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL DEBUG_MAID_K
PRINTL
ALIGNMENT CENTER
IF CHARANUM == 1
    PRINTFORMLC [1000]返回
ELSE
    PRINTFORMLC [1011]\@(TARGET == 0) ? %CALLNAME:(CHARANUM-1)% # %CALLNAME:(TARGET - 1)%\@
    PRINTFORMLC [1000]返回
    PRINTFORMLC [1019]\@(TARGET == CHARANUM-1) ? %CALLNAME:0% # %CALLNAME:(TARGET + 1)%\@
ENDIF
PRINTL
ALIGNMENT LEFT
$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 1000, 8990 TO 8992
        SIF DAY > oldDAY
            BEGIN AFTERTRAIN
        CLEARLINE LINECOUNT-(GET_CLINE(1)-50)
        TARGET = oldTARGET
        GETTIME
        IF mySAVE != "B"
        	SAVEDATA 992, RESULTS + " " + @"{DAY}日目 DEBUG修改Ａ"
        	mySAVE = B
        	mySAVE:1 = {DAY}日_%SUBSTRING(RESULTS,11,2)%時%SUBSTRING(RESULTS,14,2)%分
        ELSE
        	SAVEDATA 993, RESULTS + " " + @"{DAY}日目 DEBUG修改Ｂ"
        	mySAVE = A
        	mySAVE:2 = {DAY}日_%SUBSTRING(RESULTS,11,2)%時%SUBSTRING(RESULTS,14,2)%分
        ENDIF
        IF RESULT > 990 && RESULT < 999
    		LOADDATA RESULT
    	ENDIF
        RETURN 0
    CASE 1011
        TARGET --
        SIF TARGET <= -1
            TARGET = CHARANUM - 1
        GOTO PRINT_LIST
    CASE 1019
        TARGET ++
        SIF TARGET >= CHARANUM
            TARGET = 0
        GOTO PRINT_LIST
    CASE 1101 TO 1109
    	RESULT -= 1100
        menuFLAG:RESULT = !menuFLAG:RESULT
;通用系統修改
    CASE 101
        CALL EDIT_HEAL_ALL
    CASE 102
        CALL EDIT_ITEM("ITEM",myMODE,0)
    CASE 103
        CALL EDIT_MONEY("MONEY",myMODE,0)
    CASE 104
        CALL EDIT_FLAG("FLAG",myMODE,0)
    CASE 105
        CALL EDIT_TFLAG("TFLAG",myMODE,0)
    CASE 191
        CALL EDIT_TIME("TIME",myMODE,0)
    CASE 198
        CALL EDIT_DAY("DAY",myMODE,0)
    CASE 199
        CALL EDIT_DAY("DAY",myMODE,0)
;角色修改
    CASE 201
        CALL EDIT_ABL("ABL",myMODE,0)
    CASE 202
        CALL EDIT_EXP("EXP",myMODE,0)
    CASE 203
        CALL EDIT_TALENT("TALENT",myMODE,0)
    CASE 204
        CALL EDIT_MARK("MARK",myMODE,0)
    CASE 205
        CALL EDIT_JUEL("TUEL",myMODE,0)
    CASE 206
        CALL EDIT_BASE("BASE",myMODE,0)
    CASE 207
        CALL EDIT_EQUIP("EQUIP",myMODE,0)
    CASE 208
        CALL EDIT_TEQUIP("TEQUIP",myMODE,0)
    CASE 209
        CALL EDIT_PALAM("PALAM",myMODE,0)
    CASE 210
        CALL EDIT_EX("EX",myMODE,0)
    CASE 211
        CALL EDIT_SOURCE("SOURCE",myMODE,0)
    CASE 212
        CALL EDIT_CFLAG("CFLAG",myMODE,0)
    CASE 301
        CALL EDIT_CSTR("CSTR",myMODE,0)
    CASE 302
        CALL EDIT_TSTR("TSTR",myMODE,0)
    CASE 303
        CALL EDIT_STR("STR",myMODE,0)
    CASE 304
;其他
    CASE 401
        CALL EDIT_CHARAlist("CHARAlist",myMODE,0)
    CASE 402
        CALL EDIT_TRAIN("TRAIN",myMODE,0)
    CASE 403
        CALL EDIT_RELATION("RELATION",myMODE,0)
    CASE 404
    CASE 405
        CALL EDIT_TCVAR("TCVAR",myMODE,0)
    CASE 406
        CALL EDIT_STAIN("STAIN",myMODE,0)
    CASE 407
        CALL EDIT_GOTJUEL("GOTJUEL",myMODE,0)
    CASE 408
        CALL EDIT_NOWEX("NOWEX",myMODE,0)
    CASE  20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,"DEBUGMENU",myPAGE,myPAGE,myMODE)
ENDSELECT
RESTART

$DEBUG_END


;--------------------------------------------------
; 選擇角色
;--------------------------------------------------
@NEXT_CHARA(RESULTS,RESULT,myPAGE:1)
#DIM myPAGE,2
#DIM newNAME,3
#DIM listINT
listINT = 40
myPAGE = GET_PAGE(0,listINT,CHARANUM,0,0,0)

$PRINT_LIST
CLEARLINE LINECOUNT-GET_CLINE(1)
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORML 角色選擇
PRINTFORML 現在對象是:「%CALLNAME:TARGET%」，請問您要更換為哪個對象？
ALIGNMENT LEFT
DRAWLINE
PRINTFORMC |   |%" ",9%%"全名",11,LEFT%｜%" ",3%%"稱呼",7,LEFT%｜|   |%" ",9%%"全名",12,LEFT%｜%" ",3%%"稱呼",6,LEFT%｜
PRINTL
REPEAT CHARANUM
    IF COUNT < ((myPAGE:1+1) * listINT) && COUNT >= (myPAGE:1 * listINT)
    	SIF COUNT != 0 && (COUNT % listINT) != 0 && (COUNT % 2) == 0
        	PRINTL
        newNAME:1 = GET_INTname(0,NAME:COUNT)
        newNAME:2 = GET_INTname(0,CALLNAME:COUNT)
        PRINTFORMLC [{COUNT,3}]%NAME:COUNT,(20-newNAME:1)%｜%CALLNAME:COUNT,(10-newNAME:2),LEFT%｜
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1001]上一頁\@
PRINTLC [1000]返回
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1009]下一頁\@
PRINTL
ALIGNMENT LEFT
$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 1000
        RETURN 0
    CASE 1001
        myPAGE:1 = MY_PAGE(-1,myPAGE)
        GOTO PRINT_LIST
    CASE 1009
        myPAGE:1 = MY_PAGE(1,myPAGE)
        GOTO PRINT_LIST
    CASE 0 TO CHARANUM
        TARGET = RESULT
        PRINTFORMW 「%CALLNAME:TARGET%」 已選擇
        RETURN 0
    CASEELSE
    GOTO INPUT_LOOP
ENDSELECT
RETURN 0

;--------------------------------------------------
;對象情報
;--------------------------------------------------
@DEBUG_CHARADATA(TARGET)
#DIM newLINE
#DIM sCOUNT
#DIM cTARGET
cTARGET = TARGET
newLINE = GET_LINEint(1,8,"0")

$PRINT_LIST
CLEARLINE LINECOUNT-GET_CLINE(1)
PRINTL
DRAWLINEFORM =
PRINTFORMC 　「%NAME:TARGET% / %CALLNAME:TARGET%」
PRINTBUTTON @"  [改名]",99
PRINTL
PRINTFORMC %" " * 2% 体力 : ({BASE:TARGET:0} / {MAXBASE:TARGET:0})%" " * 2% 氣力 : ({BASE:TARGET:1} / {MAXBASE:TARGET:1})
PRINTBUTTON @"  [回復]",90
PRINTL
PRINTBUTTON @"□ 能力 □",91
;PRINTFORM \@(newLINE != 0) ? %"-" * newLINE% # %"-" * 100%\@
PRINTFORM %"-" * newLINE%
sCOUNT = 0
;REPEAT VARSIZE("ABL")
REPEAT 100
    SIF STRLENS(ABLNAME:COUNT) == 0 || COUNT > 30 && ABL:TARGET:COUNT <= 0
        CONTINUE
    IF (sCOUNT % 3) == 0 && newLINE < 75
            PRINTL
    ELSEIF (sCOUNT % 4) == 0 && newLINE >= 75
            PRINTL
    ENDIF
    PRINTFORMC %ABLNAME:COUNT,12%:{ABL:TARGET:COUNT,3,LEFT}
    sCOUNT ++
REND

PRINTL
PRINTBUTTON @"□ 刻印 □",92
;PRINTFORM \@(newLINE != 0) ? %"-" * newLINE% # %"-" * 100%\@
PRINTFORM %"-" * newLINE%
sCOUNT = 0
REPEAT VARSIZE("MARK")
    SIF STRLENS(MARKNAME:COUNT) == 0 || COUNT > 30 && MARK:TARGET:COUNT <= 0
        CONTINUE
    IF (sCOUNT % 3) == 0 && newLINE < 75
            PRINTL
    ELSEIF (sCOUNT % 4) == 0 && newLINE >= 75
            PRINTL
    ENDIF
    PRINTFORMC %MARKNAME:COUNT,12%:{MARK:TARGET:COUNT,3,LEFT}
    sCOUNT ++
REND
PRINTL
PRINTBUTTON @"□ 素質 □",93
;PRINTFORM \@(newLINE != 0) ? %"-" * newLINE% # %"-" * 100%\@
PRINTFORM %"-" * newLINE%
PRINTL
LOCALS = ""
PRINTFORM 　
REPEAT VARSIZE("TALENT")
    SIF STRLENS(TALENTNAME:COUNT) == 0
        CONTINUE
    IF TALENTNAME:COUNT == "性別"
        IF TALENT:TARGET:COUNT == 3
            PRINTFORM [扶她]
        ELSE
            CONTINUE
        ENDIF
    ELSEIF TALENTNAME:COUNT == "陽気／陰気"
        IF TALENT:TARGET:COUNT == 1
            PRINTFORM [陽気]
        ELSEIF  TALENT:TARGET:COUNT == 2
            PRINTFORM [陰気]
        ELSE
            CONTINUE
        ENDIF
    ELSEIF TALENT:TARGET:COUNT > 0
        LOCALS += TALENTNAME:COUNT+"["
        IF STRLENS(TOFULL(LOCALS)) > newLINE
                PRINTL
                PRINTFORM 　
                LOCALS = "　"
        ENDIF
        PRINTFORM [%TALENTNAME:COUNT%]
    ENDIF
REND
PRINTL
PRINTBUTTON @"□ 經驗 □",94
;PRINTFORM \@(newLINE != 0) ? %"-" * newLINE% # %"-" * 100%\@
PRINTFORM %"-" * newLINE%
sCOUNT = 0
REPEAT VARSIZE("EXP")
    SIF STRLENS(EXPNAME:COUNT) == 0 || EXP:TARGET:COUNT == 0
        CONTINUE
    IF (sCOUNT % 3) == 0 && newLINE < 75
            PRINTL
    ELSEIF (sCOUNT % 4) == 0 && newLINE >= 75
            PRINTL
    ENDIF
    IF EXP:COUNT != 0
        PRINTFORMC %EXPNAME:COUNT,12%:{EXP:TARGET:COUNT,6,LEFT}
        sCOUNT ++
    ENDIF
REND

PRINTL
DRAWLINE
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORMLC [1011]\@(TARGET == 0) ? %CALLNAME:(CHARANUM - 1)% # %CALLNAME:(TARGET - 1)%\@
PRINTFORMLC [1000]返回
PRINTFORMLC [1019]\@(TARGET == CHARANUM - 1) ? %CALLNAME:0% # %CALLNAME:(TARGET + 1)%\@
PRINTL
ALIGNMENT LEFT
INPUT
SELECTCASE RESULT
    CASE 1000
        TARGET = cTARGET
        RETURN
    CASE 1011
        TARGET --
        SIF TARGET <= -1
            TARGET = CHARANUM - 1
        GOTO PRINT_LIST
    CASE 1019
        TARGET ++
        SIF TARGET >= CHARANUM -1
            TARGET = 0
        GOTO PRINT_LIST
    CASE 90
        BASE:TARGET:0 = MAXBASE:TARGET:0
        BASE:TARGET:1 = MAXBASE:TARGET:1
        RESTART
    CASE 91
        CALL EDIT_ABL("ABL",0,0)
    CASE 92
        CALL EDIT_MARK("MARK",0,0)
    CASE 93
        CALL EDIT_TALENT("TALENT",0,0)
    CASE 94
        CALL EDIT_EXP("EXP",0,0)
    CASE 99
        CALL EDIT_CHARAname(TARGET)
    CASEELSE
ENDSELECT
;--------------------------------------------------
;改名稱
;--------------------------------------------------
@EDIT_CHARAname(TARGET)
#DIM nameFLAG
#DIMS CHARAint
CHARAint = {TARGET}
SIF STRLENS(CHARAint) == 1
    CHARAint = 0%CHARAint%
GOTO PRINT_LIST

$PRINT_NAMEedit
PRINTL
DRAWLINE
IF nameFLAG == 1
    IF TARGET == 0
        PRINTFORML 主人「%CALLNAME:TARGET%」您好♥
        PRINTFORML 您想換名子嗎！
        PRINTFORML 我很喜歡主人目前的名子，但如果您堅持的話...不，只要是主人的意思我都會執行。
        PRINTFORML 請問該如何稱呼您的新名子？
    ELSEIF  TARGET != 0
        PRINTFORML 奴隸%CHARAint%號，奴隸的名子就是奴隸，頂多就上個編號而已，竟然妄想有個好聽的新名子。
        PRINTFORML 什麼！是主人的意思...
        PRINTFORMW (呿！)沒辦法，只能做了...只能做了不是嗎！
        PRINTFORML 那你的新名子決定好了嗎？聽好了這可不是為了你！%CHARAint%
    ENDIF
    PRINTFORM (請輸入新的名稱)%" " * 12%
ELSEIF nameFLAG == 2
    IF TARGET == 0
        PRINTFORML %SUBSTRING(CALLNAME:TARGET,0,1)%...%SUBSTRING(CALLNAME:TARGET,1,1)%...，主人您好♥
        PRINTFORML 您想換暱稱嗎！
        PRINTFORML 主人就叫主人，用稱呼什麼的...太不敬了！
        PRINTFORML 希望我多用稱呼稱呼是嗎...如果是%CALLNAME:TARGET%...(主人)的意思的話
        PRINTFORML 請問該如何稱呼您的新暱稱？
    ELSEIF  TARGET != 0
        PRINTFORML 「%CALLNAME:TARGET%」？
        PRINTFORML  奴隸%CHARAint%號 你想換暱稱？
        PRINTFORML 別開玩笑了！奴隸的暱稱不是編號嗎？那是固定的！你身為奴隸一點自覺都沒有嗎%TOFULL(CHARAint)%"號？
        PRINTFORML 什麼！是主人的意思...
        PRINTFORMW (呿！)沒辦法，只能做了...只能做了不是嗎！
        PRINTFORML 那你的暱稱決定好了嗎？聽好了這可不是為了你！
    ENDIF
    DRAWLINE
    PRINTFORM (請輸入新的暱稱)%" " * 12%
ENDIF
PRINTBUTTON " [返回]", -99
PRINTL
INPUTS
STRFIND RESULTS,"-",0
IF RESULT == 0
    SIF TARGET == 0
        PRINTFORMW 　主人很抱歉，就算是您也不能這樣稱呼
    SIF TARGET != 0
        PRINTFORMW 　區區奴隸竟敢浪費我的時間，氣死我了！
    GOTO PRINT_LIST
ELSE
    IF nameFLAG == 1
        NAME:TARGET = %RESULTS%
        IF TARGET == 0
            PRINTFORML 　%SUBSTRING(NAME:TARGET,0,1)%..%SUBSTRING(NAME:TARGET,1,1)%..「%NAME:TARGET%」主人，請問新的名子還習慣嗎？
            PRINTFORML 　我的感想？明明是重要的事情卻問我的感想(\\\\\\)
            PRINTFORMW 　我很喜歡喔♥
        ELSEIF  TARGET != 0
            PRINTFORML 　%NAME:TARGET%嗎...以一個奴隸來說不算太差
            PRINTFORMW 　嘛..不喜歡也不能反悔，這可不是我的工作，我只負責主人吩咐的事物與決定罷了。
        ENDIF
    ELSEIF nameFLAG == 2
        CALLNAME:TARGET = %RESULTS%
        IF TARGET == 0
            PRINTFORML 　主人您的暱稱已更改完成。
            PRINTFORML 　什！什麼！暱稱...，要我叫暱稱太不敬了！
            PRINTFORML 　既然是主人的意思...%SUBSTRING(CALLNAME:TARGET,0,1)%..%SUBSTRING(CALLNAME:TARGET,1,1)%..%CALLNAME:TARGET%...「%CALLNAME:TARGET%」♥
            PRINTFORMW 非常好聽的暱稱 我很喜歡。
        ELSEIF  TARGET != 0
            PRINTFORML 　%CALLNAME:TARGET%嗎...以一個奴隸來說還挺有品味的嘛！
            PRINTFORMW 　但是對我而言%TOFULL(CHARAint)%才是你的稱呼方式，懂嗎?
        ENDIF
    ENDIF
ENDIF
GOTO PRINT_LIST

$PRINT_LIST
CLEARLINE LINECOUNT-GET_CLINE(1)
DRAWLINEFORM =
CALL NXP_CHARAtitle(1,"更改名稱",TARGET)
;PRINTFORML     現在名稱「%NAME:TARGET% / %CALLNAME:TARGET%」
CALL NXP_BCHARAR(2)
PRINTFORMLC 　名稱 -- %NAME:TARGET%
PRINTBUTTON " [修改]", 1
PRINTL
PRINTL
PRINTFORMLC 　暱稱 -- %CALLNAME:TARGET%
PRINTBUTTON " [修改]", 2
PRINTL
DRAWLINE
DRAWLINEFORM =
PRINTFORMLC %" " * 16%
PRINTBUTTON " [返回]", 0
PRINTL
$PRINT_NAMEmode
INPUT
SELECTCASE RESULT
    CASE 0
        RETURN 0
    CASE 1
        nameFLAG = 1
        GOTO PRINT_NAMEedit
    CASE 2
        nameFLAG = 2
        GOTO PRINT_NAMEedit
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,"NEWNAME",0,0,0)
    CASEELSE
        GOTO PRINT_NAMEmode
ENDSELECT

;--------------------------------------------------
;換主人
;--------------------------------------------------
@EDIT_MASTERswitch(RESULTS,RESULT,myPAGE:1)
#DIM myPAGE,2
#DIM CHARAlist
#DIM overALL
#DIM newNAME,3
#DIM listINT
listINT = 20
overALL = CHARANUM
myPAGE = GET_PAGE(0,listINT,overALL,0,0,0)

$PRINT_LIST
CLEARLINE LINECOUNT-GET_CLINE(1)
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORML 主人變更
PRINTFORML 「%CALLNAME:0%」大人您好，請問您要將職位交接給誰？
ALIGNMENT LEFT
DRAWLINE
;PRINTFORMC |   |%" ",9%%"全名",11,LEFT%｜%" ",3%%"稱呼",7,LEFT%｜
REPEAT overall
    IF COUNT < (myPAGE:1+1) * listINT && COUNT >= myPAGE:1 * listINT
        newNAME:1 = GET_INTname(0,NAME:COUNT)
        newNAME:2 = GET_INTname(0,CALLNAME:COUNT)
        PRINTFORMLC [{COUNT,3}]%NAME:COUNT,(20-newNAME:1)%｜%CALLNAME:COUNT,(10-newNAME:2),LEFT% - ({BASE:COUNT:0}/{MAXBASE:COUNT:0})({BASE:COUNT:1}/{MAXBASE:COUNT:1}) - 
        PRINTBUTTON "資訊 -",(100000+COUNT)
        PRINTBUTTON "更名 -",(200000+COUNT)
;       PRINTBUTTON "換人 -",(300000+COUNT)
        SIF COUNT != overall
            PRINTL
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1001]上一頁\@
PRINTLC [1000]返回
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1009]下一頁\@
PRINTL
ALIGNMENT LEFT
$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 1000
        RETURN 0
    CASE 1001
        myPAGE:1 = MY_PAGE(-1,myPAGE)
        GOTO PRINT_LIST
    CASE 1009
        myPAGE:1 = MY_PAGE(1,myPAGE)
        GOTO PRINT_LIST
    CASE 1 TO overALL
        SWAPCHARA 0,RESULT
        PRINTFORMW 恭喜「%CALLNAME:TARGET%」 成為新的主人。
    CASE  100000 TO 199999
        CHARAlist = RESULT -100000
        CALL DEBUG_CHARADATA(CHARAlist)
    CASE  200000 TO 299999
        CHARAlist = RESULT -200000
        CALL EDIT_CHARAname(CHARAlist)
;   CASE  300000 TO 399999
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; 人物管理
;--------------------------------------------------
@EDIT_CHARAlist(RESULTS,RESULT,myPAGE:1)
#DIM myPAGE,2
#DIM newNAME,3
#DIM listINT
#DIM CHARAlist
#DIM overall
overall = CHARANUM
listINT = 20
myPAGE = GET_PAGE(0,listINT,overall,0,0,0)

$PRINT_LIST
CLEARLINE LINECOUNT-GET_CLINE(1)
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORML 角色管理
ALIGNMENT LEFT
DRAWLINE
;PRINTFORMC |   |%" ",9%%"全名",11,LEFT%｜%" ",3%%"稱呼",7,LEFT%｜
REPEAT overall
    IF COUNT < (myPAGE:1+1) * listINT && COUNT >= myPAGE:1 * listINT
        newNAME:1 = GET_INTname(0,NAME:COUNT)
        newNAME:2 = GET_INTname(0,CALLNAME:COUNT)
        PRINTFORMLC [{COUNT,3}]%NAME:COUNT,(20-newNAME:1)%｜%CALLNAME:COUNT,(10-newNAME:2),LEFT% - ({BASE:COUNT:0}/{MAXBASE:COUNT:0})({BASE:COUNT:1}/{MAXBASE:COUNT:1}) - 
        PRINTBUTTON "資訊 -",(100000+COUNT)
        PRINTBUTTON "更名 -",(200000+COUNT)
;       PRINTBUTTON "換人 -",(300000+COUNT)
        SIF COUNT != overall
            PRINTL
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
DRAWLINEFORM =
ALIGNMENT CENTER
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1001]上一頁\@
PRINTLC [1000]返回
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [1009]下一頁\@
PRINTL
ALIGNMENT LEFT
$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 1000
        RETURN 0
    CASE 1001
        myPAGE:1 = MY_PAGE(-1,myPAGE)
        GOTO PRINT_LIST
    CASE 1009
        myPAGE:1 = MY_PAGE(1,myPAGE)
        GOTO PRINT_LIST
    CASE  0 TO CHARANUM
        GOTO INPUT_LOOP
    CASE  100000 TO 199999
        CHARAlist = RESULT -100000
        CALL DEBUG_CHARADATA(CHARAlist)
    CASE  200000 TO 299999
        CHARAlist = RESULT -200000
        CALL EDIT_CHARAname(CHARAlist)
;   CASE  300000 TO 399999
    CASEELSE
        TARGET = RESULT
        PRINTFORMW 「%CALLNAME:TARGET%」 已選擇
        RETURN 0
ENDSELECT
RETURN 0

;--------------------------------------------------
; ABL操作
;--------------------------------------------------
@EDIT_ABL(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM sCOUNT
#DIM NEWitem,2
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE ABL
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF ABL:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(ABLNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(ABLNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ABLNAME:COUNT) == 0) ? ABL:{COUNT} # %ABLNAME:COUNT%\@ = ({ABL:COUNT})
    ELSEIF myMODE == 1
        SIF STRLENS(ABLNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ABLNAME:COUNT) == 0) ? ABL:{COUNT} # %ABLNAME:COUNT%\@ = ({ABL:COUNT})
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ABLNAME:COUNT) == 0) ? ABL:{COUNT} # %ABLNAME:COUNT%\@ = ({ABL:COUNT})
    ELSEIF myMODE == 3
        SIF ABL:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ABLNAME:COUNT) == 0) ? ABL:{COUNT} # %ABLNAME:COUNT%\@ = ({ABL:COUNT})
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(ABLNAME:COUNT) == 0
                    CONTINUE
                ABL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                ABL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(ABLNAME:COUNT) == 0
                    CONTINUE
                ABL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                ABL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(ABLNAME:RESULT),(ABL:RESULT),9999,(-9999))
        SIF RESULT:91 == 1
            ABL:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; EXP操作
;--------------------------------------------------
@EDIT_EXP(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE EXP
overALL = RESULT

$PRINT_LIST
myMODE = NXP_MODE(1,0,0)
VARSET NEWitem,0
REPEAT overALL
    SIF EXP:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(EXPNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(EXPNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXPNAME:COUNT) == 0) ? EXP:{COUNT} # %EXPNAME:COUNT%\@ = {EXP:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(EXPNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXPNAME:COUNT) == 0) ? EXP:{COUNT} # %EXPNAME:COUNT%\@ = {EXP:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXPNAME:COUNT) == 0) ? EXP:{COUNT} # %EXPNAME:COUNT%\@ = {EXP:COUNT}
    ELSEIF myMODE == 3
        SIF EXP:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXPNAME:COUNT) == 0) ? EXP:{COUNT} # %EXPNAME:COUNT%\@ = {EXP:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
ALIGNMENT CENTER
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(EXPNAME:COUNT) == 0
                    CONTINUE
                EXP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                EXP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(EXPNAME:COUNT) == 0
                    CONTINUE
                EXP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                EXP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(EXPNAME:RESULT),(EXP:RESULT),99999,0)
        SIF RESULT:91 == 1
            EXP:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;素質編集
;--------------------------------------------------
@EDIT_TALENT(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE TALENT
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF TALENT:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(TALENTNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(TALENTNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF TALENT:COUNT < 0
            PRINTFORMLC [{COUNT, 3}]－【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 0
            PRINTFORMLC [{COUNT, 3}]×【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 1
            PRINTFORMLC [{COUNT, 3}]◎【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 2
            PRINTFORMLC [{COUNT, 3}]○【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT > 2
            PRINTFORMLC [{COUNT, 3}]△【%TALENTNAME:COUNT%】
        ENDIF
;       PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TALENTNAME:COUNT) == 0) ? TALENT:{COUNT} # %TALENTNAME:COUNT%\@ = {TALENT:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(TALENTNAME:COUNT) == 0
            CONTINUE
        IF TALENT:COUNT < 0
            PRINTFORMLC [{COUNT, 3}]－【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 0
            PRINTFORMLC [{COUNT, 3}]×【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 1
            PRINTFORMLC [{COUNT, 3}]◎【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 2
            PRINTFORMLC [{COUNT, 3}]○【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT > 2
            PRINTFORMLC [{COUNT, 3}]△【%TALENTNAME:COUNT%】
        ENDIF
;       PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TALENTNAME:COUNT) == 0) ? TALENT:{COUNT} # %TALENTNAME:COUNT%\@ = {TALENT:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF TALENT:COUNT < 0
            PRINTFORMLC [{COUNT, 3}]－【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 0
            PRINTFORMLC [{COUNT, 3}]×【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 1
            PRINTFORMLC [{COUNT, 3}]◎【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT == 2
            PRINTFORMLC [{COUNT, 3}]○【%TALENTNAME:COUNT%】
        ELSEIF TALENT:COUNT > 2
            PRINTFORMLC [{COUNT, 3}]△【%TALENTNAME:COUNT%】
        ENDIF
;       PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TALENTNAME:COUNT) == 0) ? TALENT:{COUNT} # %TALENTNAME:COUNT%\@ = {TALENT:COUNT}
    ELSEIF myMODE == 3
        SIF TALENT:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TALENTNAME:COUNT) == 0) ? TALENT:{COUNT} # %TALENTNAME:COUNT%\@ = {TALENT:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
ALIGNMENT CENTER
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(TALENTNAME:COUNT) == 0
                    CONTINUE
                TALENT:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                TALENT:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(TALENTNAME:COUNT) == 0
                    CONTINUE
                TALENT:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                TALENT:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(TALENTNAME:RESULT),(TALENT:RESULT),99,(-1))
        SIF RESULT:91 == 1
            TALENT:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; MARK操作
;--------------------------------------------------
@EDIT_MARK(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE MARK
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF MARK:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(MARKNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(MARKNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(MARKNAME:COUNT) == 0) ? MARK:{COUNT} # %MARKNAME:COUNT%\@ = {MARK:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(MARKNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(MARKNAME:COUNT) == 0) ? MARK:{COUNT} # %MARKNAME:COUNT%\@ = {MARK:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(MARKNAME:COUNT) == 0) ? MARK:{COUNT} # %MARKNAME:COUNT%\@ = {MARK:COUNT}
    ELSEIF myMODE == 3
        SIF MARK:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(MARKNAME:COUNT) == 0) ? MARK:{COUNT} # %MARKNAME:COUNT%\@ = {MARK:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)
$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
    	CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(MARKNAME:COUNT) == 0
                    CONTINUE
                MARK:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                MARK:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(MARKNAME:COUNT) == 0
                    CONTINUE
                MARK:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                MARK:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(MARKNAME:RESULT),(MARK:RESULT),99,0)
        SIF RESULT:91 == 1
            MARK:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; JUEL操作
;--------------------------------------------------
@EDIT_JUEL(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE JUEL
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF JUEL:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(PALAMNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(PALAMNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? JUEL:{COUNT} # %PALAMNAME:COUNT%の珠\@ = {JUEL:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(PALAMNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? JUEL:{COUNT} # %PALAMNAME:COUNT%の珠\@ = {JUEL:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? JUEL:{COUNT} # %PALAMNAME:COUNT%の珠\@ = {JUEL:COUNT}
    ELSEIF myMODE == 3
        SIF JUEL:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? JUEL:{COUNT} # %PALAMNAME:COUNT%の珠\@ = {JUEL:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        RESULT:90 = 1
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(PALAMNAME:COUNT) == 0
                    CONTINUE
                JUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                JUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(PALAMNAME:COUNT) == 0
                    CONTINUE
                IF RESULT:90 == 2
                    SIF PALAMNAME:COUNT == "反感"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "不快"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "抑郁"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "否定"
                        CONTINUE
                ENDIF
                JUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！\@(RESULT:90 != 2) ? (不含空值) # (不含空值、負面值)\@
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                IF RESULT:90 == 2
                    SIF PALAMNAME:COUNT == "反感"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "不快"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "抑郁"
                        CONTINUE
                    SIF PALAMNAME:COUNT == "否定"
                        CONTINUE
                ENDIF
                JUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！\@(RESULT:90 != 2) ? (不含空值) # (不含空值、負面值)\@
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        RESULT:90 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(PALAMNAME:RESULT),(JUEL:RESULT),9999999,0)
        SIF RESULT:91 == 1
            JUEL:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; BASE/MAXBASE操作
;--------------------------------------------------
@EDIT_BASE(myTITTLE,myMODE,myPAGE:1)
#DIM baseEDIT,3
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE BASE
overALL = RESULT
SIF !baseEDIT:1
    baseEDIT:1 = !baseEDIT:1

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF STRLENS(BASENAME:COUNT) != 0
        NEWitem ++
    SIF STRLENS(BASENAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
ALIGNMENT CENTER
PRINTBUTTON \@ (!baseEDIT:1) ? × 修改BASE%" " * 5% # ○ 修改BASE%" " * 5%\@,19001
PRINTBUTTON \@ (!baseEDIT:2) ? × 修改MAXBASE%" " * 5% # ○ 修改MAXBASE%" " * 5%\@,19002
PRINTL
ALIGNMENT LEFT
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(BASENAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(BASENAME:COUNT) == 0) ? BASE:{COUNT, 3} # %BASENAME:COUNT%\@ = {BASE:COUNT}({MAXBASE:COUNT})
    ELSEIF myMODE == 1
        SIF STRLENS(BASENAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(BASENAME:COUNT) == 0) ? BASE:{COUNT, 3} # %BASENAME:COUNT%\@ = {BASE:COUNT}({MAXBASE:COUNT})
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(BASENAME:COUNT) == 0) ? BASE:{COUNT, 3} # %BASENAME:COUNT%\@ = {BASE:COUNT}({MAXBASE:COUNT})
    ELSEIF myMODE == 3
        SIF BASE:COUNT == 0 && MAXBASE:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(BASENAME:COUNT) == 0) ? BASE:{COUNT, 3} # %BASENAME:COUNT%\@ = {BASE:COUNT}({MAXBASE:COUNT})
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
IF RESULT == 20009
    PRINTFORML 要搜尋BASE還是MAXBASE？
    PRINTLC [1] 搜尋BASE
    PRINTLC [2] 搜尋MAXBASE
    PRINTLC [9] 返回
    INPUT
    IF RESULT == 1
        myTITTLE = BASE
        CALL SEARCHFOR(1,myTITTLE)
    ELSEIF RESULT == 2
        myTITTLE = MAXBASE
        CALL SEARCHFOR(1,myTITTLE)
    ELSEIF RESULT == 9
        GOTO PRINT_LIST
    ENDIF
    GOTO PRINT_LIST
ENDIF
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE  19001
        baseEDIT:1 = !baseEDIT:1
        SIF !baseEDIT:1 && !baseEDIT:2
            baseEDIT:2 = !baseEDIT:2
    CASE 19002
        baseEDIT:2 = !baseEDIT:2
        SIF !baseEDIT:1 && !baseEDIT:2
            baseEDIT:1 = !baseEDIT:1
    CASE 19999
        PRINTFORML 要批量編輯BASE還是MAXBASE？
        PRINTLC [1] 編輯 BASE
        PRINTLC [2] 編輯 MAXBASE
        PRINTLC [3] 編輯 BASE & MAXBASE
        PRINTLC [9] 返回
        INPUT
        IF RESULT == 1
            myTITTLE = BASE
            baseEDIT:0 = 1
        ELSEIF RESULT == 2
            myTITTLE = MAXBASE
            baseEDIT:0 = 2
        ELSEIF RESULT == 3
            myTITTLE = BASE/MAXBASE
            baseEDIT:0 = 3
        ELSEIF RESULT == 9
            GOTO PRINT_LIST
        ENDIF
        GOTO BASE_GROUP
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        DRAWLINE
        RESULT:92 = RESULT
        SIF baseEDIT:1
            PRINTFORML BASE:{RESULT:92} %BASENAME:(RESULT:92)%修改為(現在{BASE:(RESULT:92)})
        SIF baseEDIT:2
            PRINTFORML MAXBASE:{RESULT:92} %BASENAME:(RESULT:92)%修改為(現在{MAXBASE:(RESULT:92)})
        PRINTFORML 請輸入数値[0-{9999999}]（無効数値則取消）
        PRINTLC [-99999]返回
        INPUT
        IF RESULT < 0 || RESULT > 9999999
            PRINTW 您輸入了無效值，現在返回。
        ELSE
            SIF baseEDIT:1
                BASE:(RESULT:92) = RESULT
            SIF baseEDIT:2
                MAXBASE:(RESULT:92) = RESULT
        ENDIF
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

$BASE_GROUP
CALL EDIT_GROUP(myTITTLE)
IF RESULT:91 == 0
    FOR COUNT, RESULT:92, RESULT:93
        SIF STRLENS(BASENAME:COUNT) == 0
            CONTINUE
        SIF baseEDIT:0 == 1 || baseEDIT:0 == 3
            BASE:COUNT = RESULT:94
        SIF baseEDIT:0 == 2 || baseEDIT:0 == 3
            MAXBASE:COUNT = RESULT:94
    NEXT
    PRINTFORMW 全部 \@(baseEDIT:0 != 3) ? %myTITTLE% # BASE/MAXBASE\@ 修改為({RESULT:94})了！
ELSEIF RESULT:91 == 3
    FOR COUNT, RESULT:92, RESULT:93
        SIF baseEDIT:0 == 1 || baseEDIT:0 == 3
            BASE:COUNT = RESULT:94
        SIF baseEDIT:0 == 2 || baseEDIT:0 == 3
            MAXBASE:COUNT = RESULT:94
    NEXT
    PRINTFORMW 全部 \@(baseEDIT:0 != 3) ? %myTITTLE% # BASE/MAXBASE\@ 修改為({RESULT:94})了！
ELSEIF RESULT:91 == 1
    FOR COUNT, 0, overALL
        SIF STRLENS(BASENAME:COUNT) == 0
            CONTINUE
        SIF baseEDIT:0 == 1 || baseEDIT:0 == 3
            BASE:COUNT = RESULT:94
        SIF baseEDIT:0 == 2 || baseEDIT:0 == 3
            MAXBASE:COUNT = RESULT:94
    NEXT
    PRINTFORMW 全部 \@(baseEDIT:0 != 3) ? %myTITTLE% # BASE/MAXBASE\@ 修改為({RESULT:94})了！(不含空值)
ELSEIF RESULT:91 == 2
    FOR COUNT, 0, overALL
        SIF baseEDIT:0 == 1 || baseEDIT:0 == 3
            BASE:COUNT = RESULT:94
        SIF baseEDIT:0 == 2 || baseEDIT:0 == 3
            MAXBASE:COUNT = RESULT:94
    NEXT
    PRINTFORMW 全部 \@(baseEDIT:0 != 3) ? %myTITTLE% # BASE/MAXBASE\@ 修改為({RESULT:94})了！(含空值)
ELSEIF RESULT:91 == 4
    PRINTFORMW 返回。
ENDIF
RESULT:91 = 0
GOTO PRINT_LIST

;--------------------------------------------------
; EQUIP操作
;--------------------------------------------------
@EDIT_EQUIP(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE EQUIP
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF EQUIP:COUNT != 0
    NEWitem:1 ++
    SIF STRLENS(EQUIPNAME:COUNT) != 0
    NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(EQUIPNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EQUIPNAME:COUNT) == 0) ? EQUIP:{COUNT} # %EQUIPNAME:COUNT%\@ = {EQUIP:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(EQUIPNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EQUIPNAME:COUNT) == 0) ? EQUIP:{COUNT} # %EQUIPNAME:COUNT%\@ = {EQUIP:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EQUIPNAME:COUNT) == 0) ? EQUIP:{COUNT} # %EQUIPNAME:COUNT%\@ = {EQUIP:COUNT}
    ELSEIF myMODE == 3
        SIF EQUIP:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EQUIPNAME:COUNT) == 0) ? EQUIP:{COUNT} # %EQUIPNAME:COUNT%\@ = {EQUIP:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(EQUIPNAME:COUNT) == 0
                    CONTINUE
                EQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                EQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(EQUIPNAME:COUNT) == 0
                    CONTINUE
                EQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                EQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(EQUIPNAME:RESULT),(EQUIP:RESULT),999,0)
        SIF RESULT:91 == 1
            EQUIP:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; TEQUIP操作
;--------------------------------------------------
@EDIT_TEQUIP(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE TEQUIP
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF TEQUIP:COUNT != 0
    NEWitem:1 ++
    SIF STRLENS(TEQUIPNAME:COUNT) != 0
    NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(TEQUIPNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TEQUIPNAME:COUNT) == 0) ? TEQUIP:{COUNT} # %TEQUIPNAME:COUNT%\@ = {TEQUIP:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(TEQUIPNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TEQUIPNAME:COUNT) == 0) ? TEQUIP:{COUNT} # %TEQUIPNAME:COUNT%\@ = {TEQUIP:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TEQUIPNAME:COUNT) == 0) ? TEQUIP:{COUNT} # %TEQUIPNAME:COUNT%\@ = {TEQUIP:COUNT}
    ELSEIF myMODE == 3
        SIF TEQUIP:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TEQUIPNAME:COUNT) == 0) ? TEQUIP:{COUNT} # %TEQUIPNAME:COUNT%\@ = {TEQUIP:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(TEQUIPNAME:COUNT) == 0
                    CONTINUE
                TEQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                TEQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(TEQUIPNAME:COUNT) == 0
                    CONTINUE
                TEQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                TEQUIP:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(TEQUIPNAME:RESULT),(TEQUIP:RESULT),999,0)
        SIF RESULT:91 == 1
            TEQUIP:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; PALAM操作
;--------------------------------------------------
@EDIT_PALAM(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE PALAM
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF PALAM:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(PALAMNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(PALAMNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? PALAM:{COUNT} # %PALAMNAME:COUNT%\@ = {PALAM:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(PALAMNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? PALAM:{COUNT} # %PALAMNAME:COUNT%\@ = {PALAM:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? PALAM:{COUNT} # %PALAMNAME:COUNT%\@ = {PALAM:COUNT}
    ELSEIF myMODE == 3
        SIF PALAM:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(PALAMNAME:COUNT) == 0) ? PALAM:{COUNT} # %PALAMNAME:COUNT%\@ = {PALAM:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(PALAMNAME:COUNT) == 0
                    CONTINUE
                PALAM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                PALAM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(PALAMNAME:COUNT) == 0
                    CONTINUE
                PALAM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                PALAM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(PALAMNAME:RESULT),(PALAM:RESULT),9999999,0)
        SIF RESULT:91 == 1
            PALAM:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; EX操作
;--------------------------------------------------
@EDIT_EX(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE EX
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF EX:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(EXNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(EXNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXNAME:COUNT) == 0) ? EX:{COUNT} # %EXNAME:COUNT%\@ = {EX:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(EXNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXNAME:COUNT) == 0) ? EX:{COUNT} # %EXNAME:COUNT%\@ = {EX:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXNAME:COUNT) == 0) ? EX:{COUNT} # %EXNAME:COUNT%\@ = {EX:COUNT}
    ELSEIF myMODE == 3
        SIF EX:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(EXNAME:COUNT) == 0) ? EX:{COUNT} # %EXNAME:COUNT%\@ = {EX:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(EXNAME:COUNT) == 0
                    CONTINUE
                EX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                EX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(EXNAME:COUNT) == 0
                    CONTINUE
                EX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                EX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(EXNAME:RESULT),(EX:RESULT),9999999,0)
        SIF RESULT:91 == 1
            EX:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; SOURCE操作
;--------------------------------------------------
@EDIT_SOURCE(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE SOURCE
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF SOURCE:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(SOURCENAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(SOURCENAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(SOURCENAME:COUNT) == 0) ? SOURCE:{COUNT} # %SOURCENAME:COUNT%\@ = {SOURCE:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(SOURCENAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(SOURCENAME:COUNT) == 0) ? SOURCE:{COUNT} # %SOURCENAME:COUNT%\@ = {SOURCE:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(SOURCENAME:COUNT) == 0) ? SOURCE:{COUNT} # %SOURCENAME:COUNT%\@ = {SOURCE:COUNT}
    ELSEIF myMODE == 3
        SIF SOURCE:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(SOURCENAME:COUNT) == 0) ? SOURCE:{COUNT} # %SOURCENAME:COUNT%\@ = {SOURCE:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(SOURCENAME:COUNT) == 0
                    CONTINUE
                SOURCE:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                SOURCE:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(SOURCENAME:COUNT) == 0
                    CONTINUE
                SOURCE:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                SOURCE:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(SOURCENAME:RESULT),(SOURCE:RESULT),9999999,0)
        SIF RESULT:91 == 1
            SOURCE:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST


;--------------------------------------------------
; CFLAG操作
;--------------------------------------------------
@EDIT_CFLAG(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE CFLAG
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF CFLAG:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(CFLAGNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(CFLAGNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(CFLAGNAME:COUNT) == 0) ? CFLAG:{COUNT} # %CFLAGNAME:COUNT%\@ = {CFLAG:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(CFLAGNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(CFLAGNAME:COUNT) == 0) ? CFLAG:{COUNT} # %CFLAGNAME:COUNT%\@ = {CFLAG:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(CFLAGNAME:COUNT) == 0) ? CFLAG:{COUNT} # %CFLAGNAME:COUNT%\@ = {CFLAG:COUNT}
    ELSEIF myMODE == 3
        SIF CFLAG:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(CFLAGNAME:COUNT) == 0) ? CFLAG:{COUNT} # %CFLAGNAME:COUNT%\@ = {CFLAG:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
    	CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(CFLAGNAME:COUNT) == 0
                    CONTINUE
                CFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                CFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(CFLAGNAME:COUNT) == 0
                    CONTINUE
                CFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                CFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(CFLAGNAME:RESULT),(CFLAG:RESULT),999999,(-9999))
        SIF RESULT:91 == 1
            CFLAG:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;STR操作
;--------------------------------------------------
@EDIT_STR(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM maxINT,4
#DIMS nNAME
#DIMS myTITTLE
VARSET maxINT,0
VARSIZE STR
overALL = RESULT
maxINT = GET_LINEint(2,20,"0")
maxINT:1 = GET_LINEint(2,8,"0")

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF STRLENS(STR:COUNT) != 0
        NEWitem:1 ++
    SIF STRLENS(STRNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(STRNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(STR:COUNT) != 0) ? %STR:COUNT% # STR:{COUNT,2}\@
    ELSEIF myMODE == 1
        SIF STRLENS(STRNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(STR:COUNT) != 0) ? %STR:COUNT% # STR:{COUNT,2}\@
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(STR:COUNT) != 0) ? %STR:COUNT% # STR:{COUNT,2}\@
    ELSEIF myMODE == 3
        SIF STRLENS(STR:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(STR:COUNT) != 0) ? %STR:COUNT% # STR:{COUNT,2}\@
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,0)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 20000 TO 30000
        CALL NXP_BRESULT(2,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
    CASE 0 TO overALL
        CALL GET_txtEDIT(RESULT,myTITTLE,(STRNAME:RESULT),(STR:RESULT),TARGET,1)
        SIF STRLENS(RESULTS) != 0
			STR:RESULT = %RESULTS%
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;CSTR編輯
;--------------------------------------------------
@EDIT_CSTR(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM maxINT,4
#DIMS nNAME
#DIMS myTITTLE
VARSET maxINT,0
VARSIZE CSTR
overALL = RESULT
maxINT = GET_LINEint(2,20,"0")
maxINT:1 = GET_LINEint(2,8,"0")

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF STRLENS(CSTR:COUNT) != 0
        NEWitem:1 ++
    SIF STRLENS(CSTRNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(CSTRNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(CSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(CSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ : %CSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 1
        SIF STRLENS(CSTRNAME:COUNT) == 0
            CONTINUE
        IF STRLENS(TOFULL(CSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(CSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ : %CSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(CSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(CSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ : %CSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 3
        SIF STRLENS(CSTR:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(CSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(CSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(CSTRNAME:COUNT) == 0) ? CSTR:{COUNT,3} # %CSTRNAME:COUNT%\@ : %CSTR:COUNT%
        ENDIF
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,0)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 20000 TO 30000
        CALL NXP_BRESULT(2,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
    CASE 0 TO overALL
        CALL GET_txtEDIT(RESULT,myTITTLE,(CSTRNAME:RESULT),(CSTR:RESULT),TARGET,1)
        SIF STRLENS(RESULTS) != 0
            CSTR:RESULT = %RESULTS%
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;TSTR編輯
;--------------------------------------------------
@EDIT_TSTR(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM maxINT,4
#DIMS nNAME
#DIMS myTITTLE
VARSET maxINT,0
VARSIZE TSTR
overALL = RESULT
maxINT = GET_LINEint(2,20,"0")
maxINT:1 = GET_LINEint(2,8,"0")

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF STRLENS(TSTR:COUNT) != 0
        NEWitem:1 ++
    SIF STRLENS(TSTRNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(TSTRNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(TSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(TSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ : %TSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 1
        SIF STRLENS(TSTRNAME:COUNT) == 0
            CONTINUE
        IF STRLENS(TOFULL(TSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(TSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ : %TSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(TSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(TSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ : %TSTR:COUNT%
        ENDIF
    ELSEIF myMODE == 3
        SIF STRLENS(TSTR:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        IF STRLENS(TOFULL(TSTR:COUNT)) > maxINT
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ :
            CALL NXP_PRINTlist(TSTR:COUNT,maxINT)
        ELSE
            PRINTFORML [{COUNT, 3}] \@ (STRLENS(TSTRNAME:COUNT) == 0) ? TSTR:{COUNT,3} # %TSTRNAME:COUNT%\@ : %TSTR:COUNT%
        ENDIF
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,0)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 20000 TO 30000
        CALL NXP_BRESULT(2,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
    CASE 0 TO overALL
        CALL GET_txtEDIT(RESULT,myTITTLE,(TSTRNAME:RESULT),(TSTR:RESULT),TARGET,1)
        SIF STRLENS(RESULTS) != 0
            TSTR:RESULT = %RESULTS%
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;======================================================================================================
;------------------------------------------------其他資訊-----------------------------------------------
;======================================================================================================
;--------------------------------------------------
;全角色全回復
;--------------------------------------------------
@EDIT_HEAL_ALL
#DIM sCOUNT,5
#DIM s2COUNT,5
VARSET sCOUNT,0
REPEAT VARSIZE("BASE")
    IF COUNT == 0 || COUNT == 1
        sCOUNT ++
        sCOUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"勃起"
    IF RESULT > -1
        sCOUNT ++
        sCOUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"精力"
    IF RESULT > -1
        sCOUNT:0 ++
        sCOUNT:sCOUNT = COUNT
    ENDIF
REND
REPEAT VARSIZE("BASE")
    STRFIND BASENAME:COUNT,"ストレス"
    IF RESULT > -1
        s2COUNT ++
        s2COUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"压力"
    IF RESULT > -1
        s2COUNT ++
        s2COUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"疲労"
    IF RESULT > -1
        s2COUNT ++
        s2COUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"眠気"
    IF RESULT > -1
        s2COUNT ++
        s2COUNT:sCOUNT = COUNT
    ENDIF
    STRFIND BASENAME:COUNT,"不潔"
    IF RESULT > -1
        s2COUNT ++
        s2COUNT:sCOUNT = COUNT
    ENDIF
REND
FOR s2COUNT,0,5
    REPEAT CHARANUM
        BASE:COUNT:(s2COUNT:s2COUNT) = 0
    REND
NEXT
FOR sCOUNT,0,5
    REPEAT CHARANUM
        BASE:COUNT:(sCOUNT:sCOUNT) = MAXBASE:COUNT:(sCOUNT:sCOUNT)
    REND
NEXT
PRINTW ＊＊＊全員体力、氣力已經回復＊＊＊

;--------------------------------------------------
; ITEM操作
;--------------------------------------------------
@EDIT_ITEM(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM myEDIT,4
#DIMS myTITTLE
VARSIZE ITEM
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF ITEM:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(ITEMNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(ITEMNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ITEMNAME:COUNT) == 0) ? ITEM:{COUNT} # %ITEMNAME:COUNT%\@ = {ITEM:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(ITEMNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ITEMNAME:COUNT) == 0) ? ITEM:{COUNT} # %ITEMNAME:COUNT%\@ = {ITEM:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ITEMNAME:COUNT) == 0) ? ITEM:{COUNT} # %ITEMNAME:COUNT%\@ = {ITEM:COUNT}
    ELSEIF myMODE == 3
        SIF ITEM:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(ITEMNAME:COUNT) == 0) ? ITEM:{COUNT} # %ITEMNAME:COUNT%\@ = {ITEM:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(ITEMNAME:COUNT) == 0
                    CONTINUE
                ITEM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                ITEM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(ITEMNAME:COUNT) == 0
                    CONTINUE
                ITEM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                ITEM:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(ITEMNAME:RESULT),(ITEM:RESULT),999,0)
        SIF RESULT:91 == 1
            ITEM:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;MONEY変更処理
;--------------------------------------------------
@EDIT_MONEY(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE MONEY
overALL = RESULT
myMODE = 3

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
   SIF MONEY:COUNT != 0
       NEWitem:1 ++
;   SIF MONEYNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]貨幣:{COUNT, 3} = %TOSTR(MONEY:COUNT, "#,##0"),10,LEFT%
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF MONEY:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] MONEY:{COUNT} = %TOSTR(MONEY:COUNT, "#,##0"),10,LEFT%
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(MONEYNAME:COUNT) == 0
;                   CONTINUE
;               MONEYCOUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                MONEY:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(MONEYNAME:COUNT) == 0
;                   CONTINUE
;               MONEY:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                MONEY:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"MONEY",MONEY:RESULT,999999999,0)
        SIF RESULT:91 == 1
            MONEY:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST
;--------------------------------------------------
;FLAG編集
;--------------------------------------------------
@EDIT_FLAG(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE FLAG
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF FLAG:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(FLAGNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(FLAGNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(FLAGNAME:COUNT) == 0) ? FLAG:{COUNT} # %FLAGNAME:COUNT%\@ = {FLAG:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(FLAGNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(FLAGNAME:COUNT) == 0) ? FLAG:{COUNT} # %FLAGNAME:COUNT%\@ = {FLAG:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(FLAGNAME:COUNT) == 0) ? FLAG:{COUNT} # %FLAGNAME:COUNT%\@ = {FLAG:COUNT}
    ELSEIF myMODE == 3
        SIF FLAG:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(FLAGNAME:COUNT) == 0) ? FLAG:{COUNT} # %FLAGNAME:COUNT%\@ = {FLAG:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(FLAGNAME:COUNT) == 0
                    CONTINUE
                FLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                FLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(FLAGNAME:COUNT) == 0
                    CONTINUE
                FLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                FLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(FLAGNAME:RESULT),(FLAG:RESULT),999999,(-9999))
        SIF RESULT:91 == 1
            FLAG:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;TFLAG編集
;--------------------------------------------------
@EDIT_TFLAG(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE TFLAG
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF TFLAG:COUNT != 0
        NEWitem:1 ++
    SIF STRLENS(TFLAGNAME:COUNT) != 0
        NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,NEWitem,0,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
    IF myMODE == 0
        SIF STRLENS(TFLAGNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TFLAGNAME:COUNT) == 0) ? TFLAG:{COUNT} # %TFLAGNAME:COUNT%\@ = {TFLAG:COUNT}
    ELSEIF myMODE == 1
        SIF STRLENS(TFLAGNAME:COUNT) == 0
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TFLAGNAME:COUNT) == 0) ? TFLAG:{COUNT} # %TFLAGNAME:COUNT%\@ = {TFLAG:COUNT}
    ELSEIF myMODE == 2
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TFLAGNAME:COUNT) == 0) ? TFLAG:{COUNT} # %TFLAGNAME:COUNT%\@ = {TFLAG:COUNT}
    ELSEIF myMODE == 3
        SIF TFLAG:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@ (STRLENS(TFLAGNAME:COUNT) == 0) ? TFLAG:{COUNT} # %TFLAGNAME:COUNT%\@ = {TFLAG:COUNT}
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(1,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
            FOR COUNT, RESULT:92, RESULT:93
                SIF STRLENS(TFLAGNAME:COUNT) == 0
                    CONTINUE
                TFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                TFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
            FOR COUNT, 0, overALL
                SIF STRLENS(TFLAGNAME:COUNT) == 0
                    CONTINUE
                TFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                TFLAG:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,(TFLAGNAME:RESULT),(TFLAG:RESULT),999999,(-9999))
        SIF RESULT:91 == 1
            TFLAG:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST


;--------------------------------------------------
;EDIT_TIME
;--------------------------------------------------
@EDIT_TIME(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE TIME
overALL = RESULT
myMODE = 3

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF TIME:COUNT != 0
        NEWitem:1 ++
;	SIF TIMENAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]TIME:{COUNT, 3} = {TIME:COUNT,4,LEFT}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF TIME:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] TIME:{COUNT} = {TIME:COUNT,4,LEFT}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(TIMENAME:COUNT) == 0
;                   CONTINUE
;               TIME:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                TIME:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(TIMENAME:COUNT) == 0
;                   CONTINUE
;               TIME:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                TIME:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"TIME",TIME:RESULT,999999999,0)
        SIF RESULT:91 == 1
            TIME:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;EDIT_DAY
;--------------------------------------------------
@EDIT_DAY(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
SIF RESULT ==199
    GOTO GONEXTDAY
VARSIZE DAY
overALL = RESULT
myMODE = 3

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF DAY:COUNT != 0
        NEWitem:1 ++
;   SIF DAYNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]DAY:{COUNT, 3} = {DAY:COUNT,3,LEFT}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF DAY:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] DAY:{COUNT} = {DAY:COUNT,3,LEFT}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(DAYNAME:COUNT) == 0
;                   CONTINUE
;               DAY:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                DAY:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(DAYNAME:COUNT) == 0
;                   CONTINUE
;               DAY:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                DAY:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"DAY",DAY:RESULT,9999,0)
        SIF RESULT:91 == 1
            DAY:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

$GONEXTDAY
PRINTL 確定到下一天?
PRINTL
DRAWLINEFORM =
PRINTC [0]NO
PRINTC [1]YES
INPUT
IF RESULT
    DAY += 1
    PRINTFORMW 注意！退出DEBUG菜单后生效
    RETURN 0
ELSE
    RETURN 0
ENDIF
RETURN 0

;--------------------------------------------------
; RELATION操作
;--------------------------------------------------
@EDIT_RELATION(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE RELATION
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF RELATION:COUNT != 0
        NEWitem:1 ++
;   SIF RELATIONNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]RELATION:{COUNT, 3} = {RELATION:COUNT,3}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF RELATION:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]RELATION:{COUNT,3} = {RELATION:COUNT,3}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(RELATIONNAME:COUNT) == 0
;                   CONTINUE
;               RELATION:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                RELATION:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(RELATIONNAME:COUNT) == 0
;                   CONTINUE
;               RELATION:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                RELATION:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"RELATION",RELATION:RESULT,999999999,0)
        SIF RESULT:91 == 1
            RELATION:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
; TCVAR操作
;--------------------------------------------------
@EDIT_TCVAR(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE TCVAR
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF TCVAR:COUNT != 0
        NEWitem:1 ++
;   SIF TCVARNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]TCVAR:{COUNT, 3} = {TCVAR:COUNT,3}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF TCVAR:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] TCVAR:{COUNT} = {TCVAR:COUNT,3}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(TCVARNAME:COUNT) == 0
;                   CONTINUE
;               TCVAR:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                TCVAR:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(TCVARNAME:COUNT) == 0
;                   CONTINUE
;               TCVAR:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                TCVAR:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"TCVAR",TCVAR:RESULT,99999,0)
        SIF RESULT:91 == 1
            TCVAR:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;EDIT_STAIN
;--------------------------------------------------
@EDIT_STAIN(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM myEDIT,4
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE STAIN
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF STAIN:COUNT != 0
        NEWitem:1 ++
;   SIF STAINNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]STAIN:{COUNT, 3} = {STAIN:COUNT,3}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF STAIN:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] STAIN:{COUNT} = {STAIN:COUNT,3}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(STAINNAME:COUNT) == 0
;                   CONTINUE
;               STAIN:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                STAIN:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(STAINNAME:COUNT) == 0
;                   CONTINUE
;               STAIN:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                STAIN:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"STAIN",STAIN:RESULT,99999,0)
        SIF RESULT:91 == 1
            STAIN:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;EDIT_GOTJUEL
;--------------------------------------------------
@EDIT_GOTJUEL(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM myEDIT,4
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE GOTJUEL
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF GOTJUEL:COUNT != 0
        NEWitem:1 ++
;   SIF GOTJUELNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]GOTJUEL:{COUNT, 3} = {GOTJUEL:COUNT,7}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF GOTJUEL:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] GOTJUEL:{COUNT} = {GOTJUEL:COUNT,7}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(GOTJUELNAME:COUNT) == 0
;                   CONTINUE
;               GOTJUEL:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                GOTJUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(GOTJUELNAME:COUNT) == 0
;                   CONTINUE
;               GOTJUEL:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                GOTJUEL:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"GOTJUEL",GOTJUEL:RESULT,99999,0)
        SIF RESULT:91 == 1
            GOTJUEL:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;EDIT_NOWEX
;--------------------------------------------------
@EDIT_NOWEX(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM NEWitem,2
#DIM myEDIT,4
#DIM sCOUNT
#DIM overALL
#DIMS myTITTLE
VARSIZE NOWEX
overALL = RESULT

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
    SIF NOWEX:COUNT != 0
        NEWitem:1 ++
;   SIF NOWEXNAME:COUNT != 0
;       NEWitem ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(2,myTITTLE,overALL,0,NEWitem:1,myMODE)
DRAWLINE
IF myMODE != 3
    REPEAT overALL
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}]NOWEX:{COUNT, 3} = {NOWEX:COUNT}
    REND
ELSEIF myMODE == 3
    REPEAT overALL
        SIF NOWEX:COUNT == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] NOWEX:{COUNT} = {NOWEX:COUNT}
    REND
ENDIF
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 19999
        CALL EDIT_GROUP(myTITTLE)
        IF RESULT:91 == 0
;           FOR COUNT, RESULT:92, RESULT:93
;               SIF STRLENS(NOWEXNAME:COUNT) == 0
;                   CONTINUE
;               NOWEX:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 3
            FOR COUNT, RESULT:92, RESULT:93
                NOWEX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 範圍內 %myTITTLE% 全部修改為({RESULT:94})了！
        ELSEIF RESULT:91 == 1
;           FOR COUNT, 0, overALL
;               SIF STRLENS(NOWEXNAME:COUNT) == 0
;                   CONTINUE
;               NOWEX:COUNT = RESULT:94
;           NEXT
;           PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(不含空值)
            PRINTFORMW 無效動作，返回
        ELSEIF RESULT:91 == 2
            FOR COUNT, 0, overALL
                NOWEX:COUNT = RESULT:94
            NEXT
            PRINTFORMW 全部 %myTITTLE% 修改為({RESULT:94})了！(含空值)
        ELSEIF RESULT:91 == 4
            PRINTFORMW 返回。
        ENDIF
        RESULT:91 = 0
        GOTO PRINT_LIST
    CASE 20000 TO 30000
        CALL NXP_BRESULT(1,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
        myPAGE:1 =  MY_PAGE(0,-1)
    CASE 0 TO overALL
        RESULT:92 = RESULT
        CALL GET_intEDIT(RESULT:92,myTITTLE,"NOWEX",NOWEX:RESULT,99999,0)
        SIF RESULT:91 == 1
            NOWEX:(RESULT:92) = RESULT:94
        RESULT:91 = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;--------------------------------------------------
;TRAIN操作
;--------------------------------------------------
@EDIT_TRAIN(myTITTLE,myMODE,myPAGE:1)
#DIM myPAGE,2
#DIM myMODE
#DIM myEDIT,4
#DIM NEWitem,2
#DIM sCOUNT
#DIM overALL
#DIM maxINT,4
#DIMS nNAME
#DIMS myTITTLE
VARSET maxINT,0
VARSIZE TRAINNAME
overALL = RESULT
maxINT = GET_LINEint(2,20,"0")
maxINT:1 = GET_LINEint(2,8,"0")

$PRINT_LIST
VARSET NEWitem,0
myMODE = NXP_MODE(1,0,0)
REPEAT overALL
;   SIF TRAIN:COUNT != 0
;       NEWitem:1 ++
    SIF STRLENS(TRAINNAME:COUNT) != 0
        NEWitem:1 ++
REND
sCOUNT = 0
CLEARLINE LINECOUNT-GET_CLINE(1)
myPAGE = GET_PAGE(myMODE,RESULT:81,overALL,overALL,overALL,NEWitem:1)
PRINTL
DRAWLINEFORM =
CALL NXP_title(1,myTITTLE,overALL,NEWitem,NEWitem:1,myMODE)
CALL NXP_BCHARAR(1)
REPEAT overALL
;   IF myMODE == 0
;       SIF STRLENS(TRAINNAME:COUNT) == 0
;           CONTINUE
;       sCOUNT ++
;       SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
;           CONTINUE
;       PRINTFORMLC [{COUNT, 3}] \@(STRLENS(TRAINNAME:COUNT) != 0) ? %TRAINNAME:COUNT% # TRAIN:{COUNT,3}\@
    IF myMODE != 3
        SIF COUNT < myPAGE:1 * RESULT:81 || COUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(TRAINNAME:COUNT) != 0) ? %TRAINNAME:COUNT% # TRAIN:{COUNT,3}\@
;   ELSEIF myMODE == 2
;       SIF STRLENS(TRAINNAME:COUNT) == 0
;           CONTINUE
;       PRINTFORMLC [{COUNT, 3}] \@(STRLENS(TRAINNAME:COUNT) != 0) ? %TRAINNAME:COUNT% # TRAIN:{COUNT,3}\@
    ELSEIF myMODE == 3
        SIF STRLENS(TRAINNAME:COUNT) == 0
            CONTINUE
        sCOUNT ++
        SIF sCOUNT < myPAGE:1 * RESULT:81 || sCOUNT >= (myPAGE:1 + 1) * RESULT:81
            CONTINUE
        PRINTFORMLC [{COUNT, 3}] \@(STRLENS(TRAINNAME:COUNT) != 0) ? %TRAINNAME:COUNT% # TRAIN:{COUNT,3}\@
    ENDIF
REND
PRINTL
CALL NXP_BPAGE(myPAGE:1,myPAGE)
DRAWLINE
CALL NXP_BMODE(2,myMODE)
CALL NXP_BUSER(myPAGE,1)

$INPUT_LOOP
INPUT
SELECTCASE RESULT
    CASE 10000
        RETURN 0
    CASE 20000 TO 30000
        CALL NXP_BRESULT(2,RESULT,myTITTLE,myPAGE:1,myPAGE,myMODE)
    CASE 0 TO overALL
        CALL GET_txtEDIT(RESULT,myTITTLE,(TRAINNAME:RESULT),(TRAINNAME:RESULT),TARGET,1)
        SIF STRLENS(RESULTS) != 0
;           TRAINNAME:RESULT = %RESULTS%
			RESULT = 0
    CASEELSE
        GOTO PRINT_LIST
ENDSELECT
GOTO PRINT_LIST

;==============================================================================================
;--------------------------------------------以下補丁--------------------------------------------
;==============================================================================================
;=================
;---------顯示與結果--------
;=================
;检索函数___by.LJ
@SEARCHFOR(resultFLAG,SEARCHFORname)
#DIM resultFLAG
#DIMS SEARCHFORname
#DIMS ESCname,3
ESCname:0 = 返回
ESCname:1 = ESC
ESCname:2 = esc
PRINTL
$LOOP_SEARCH
DRAWLINEFORM =
PRINTFORML 输入需要检索的%SEARCHFORname%的值\@(resultFLAG == 1) ?（輸入-999999則返回） # （離開請輸入返回/ESC）\@
PRINTFORM %" "*10%
IF resultFLAG == 1
    PRINTBUTTON @" [返回] ",-999999
    INPUT
ELSEIF resultFLAG == 2
    PRINTBUTTON @" [返回] ","返回"
    INPUTS
ENDIF
IF resultFLAG == 1
    IF RESULT == -999999
        PRINTW 返回
        DRAWLINE
        RETURN
    ELSE
        PRINTFORML %SEARCHFORname%的值為{RESULT}有
        SELECTCASE SEARCHFORname
            CASE "FLAG"
                REPEAT VARSIZE("FLAG")
                    SIF FLAG:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%FLAGNAME:COUNT%】
                REND
            CASE "CFLAG"
                REPEAT VARSIZE("CFLAG")
                    SIF CFLAG:COUNT == RESULT
                        PRINTFORMLC [COUNT]:【%CFLAGNAME:COUNT%】
                REND
            CASE "TFLAG"
                REPEAT VARSIZE("TFLAG")
                    SIF TFLAG:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%TFLAGNAME:COUNT%】
                REND
            CASE "BASE"
                REPEAT VARSIZE("BASE")
                    SIF BASE:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%BASENAME:COUNT%】
                REND
            CASE "BASE","MAXBASE"
                REPEAT VARSIZE("MAXBASE")
                    SIF MAXBASE:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%BASENAME:COUNT%】
                REND
            CASE "EXP"
                REPEAT VARSIZE("EXP")
                    SIF EXP:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%EXPNAME:COUNT%】
                REND
            CASE "ABL"
                REPEAT VARSIZE("ABL")
                    SIF ABL:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%ABLNAME:COUNT%】
                REND
            CASE "TALENT"
                REPEAT VARSIZE("TALENT")
                    SIF TALENT:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%TALENTNAME:COUNT%】
                REND
            CASE "PALAM"
                REPEAT VARSIZE("PALAM")
                    SIF PALAM:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%PALAMNAME:COUNT%】
                REND
            CASE "JUEL"
                REPEAT VARSIZE("JUEL")
                    SIF JUEL:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%PALAMNAME:COUNT%の珠】
                REND
            CASE "EX"
                REPEAT VARSIZE("EX")
                    SIF EX:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%EXNAME:COUNT%の珠】
                REND
            CASE "SOURCE"
                REPEAT VARSIZE("SOURCE")
                    SIF SOURCE:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%SOURCENAME:COUNT%の珠】
                REND
            CASE "EQUIP"
                REPEAT VARSIZE("EQUIP")
                    SIF EQUIP:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%EQUIPNAME:COUNT%】
                REND
            CASE "TEQUIP"
                REPEAT VARSIZE("TEQUIP")
                    SIF TEQUIP:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%TEQUIPNAME:COUNT%】
                REND
            CASE "ITEM"
                REPEAT VARSIZE("ITEM")
                    SIF ITEM:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%ITEMNAME:COUNT%】
                REND
                CASE "MARK"
                REPEAT VARSIZE("MARK")
                    SIF MARK:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【%MARKNAME:COUNT%】
                REND
            CASE "RELATION"
                REPEAT VARSIZE("RELATION")
                    SIF RELATION:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【{RELATION:COUNT}】
                REND
            CASE "STAIN"
                REPEAT VARSIZE("STAIN")
                    SIF STAIN:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【{STAIN:COUNT}】
                REND
            CASE "GOTJUEL"
                REPEAT VARSIZE("GOTJUEL")
                    SIF GOTJUEL:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【{GOTJUEL:COUNT}】
                REND
            CASE "NOWEX"
                REPEAT VARSIZE("NOWEX")
                    SIF NOWEX:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【{NOWEX:COUNT}】
                REND
            CASE "TCVAR"
                REPEAT VARSIZE("TCVAR")
                    SIF TCVAR:COUNT == RESULT
                        PRINTFORMLC [{COUNT}]:【{TCVAR:COUNT}】
                REND
            CASEELSE
                RETURN 0
        ENDSELECT
    ENDIF
ELSEIF resultFLAG == 2
    IF RESULTS == ESCname:0 || RESULTS == ESCname:1 || RESULTS == ESCname:2
        PRINTW 返回
        DRAWLINE
        RETURN
    ELSE
        PRINTFORML %SEARCHFORname%的值為%RESULTS%有
        SELECTCASE SEARCHFORname
            CASE "STR"
                REPEAT VARSIZE("STR")
                    SIF STRFIND(STR:COUNT,RESULTS,-1) != -1
                        PRINTFORMLC [{COUNT}]:【%STR:COUNT%】
                REND
            CASE "CSTR"
                REPEAT VARSIZE("CSTR")
                    SIF STRFIND(CSTR:TARGET:COUNT,RESULTS,-1) != -1
                        PRINTFORMLC [{COUNT}]:【%CSTR:TARGET:COUNT%】
                REND
            CASE "TSTR"
                REPEAT VARSIZE("TSTR")
                    SIF STRFIND(TSTR:COUNT,RESULTS,-1) != -1
                        PRINTFORMLC [{COUNT}]:【%TSTR:COUNT%】
                REND
            CASE "TRAIN"
                REPEAT VARSIZE("TRAINNAME")
                    SIF STRFIND(TRAINNAME:COUNT,RESULTS,-1) != -1
                        PRINTFORMLC [{COUNT}]:【%TRAINNAME:COUNT%】
                REND
            CASEELSE
                RETURN 0
        ENDSELECT
    ENDIF
ENDIF
PRINTL
GOTO LOOP_SEARCH


;字串編輯
@GET_txtEDIT(nINT,nTXT,nTXT:1,nTXT:2,TARGET,showMODE)
#DIM showMODE
#DIM nINT,3
#DIMS nTXT,3
DRAWLINE
PRINTFORML 　%nTXT%:{nINT}【%nTXT:1%】
PRINTFORML 　(%nTXT:2%)
PRINTFORML 　修改為...　請輸入文字(輸入 -99 / 返回 / ESC 則返回)
PRINTBUTTON @"　返回　","返回"
INPUTS
IF RESULTS == "-99" || RESULTS == "返回" || RESULTS == "ESC" || RESULTS == "esc"
    PRINTW 您輸入了無效值，現在返回。
    RESULTS = 
ENDIF
RETURN RESULT


;數值編輯
@GET_intEDIT(nINT:3,showNAME,showNAME:1,nINT:0,nINT:1,nINT:2)
#DIM nINT,4
#DIMS showNAME,2
DRAWLINE
PRINTFORML %showNAME%:{nINT:3} %showNAME%修改為(現在{nINT:0})
PRINTFORML 請輸入数値[{nINT:2}-{nINT:1}]（無効数値則取消）
PRINTBUTTON @"　返回　",-99999
PRINTBUTTON @"　最小值　",0
PRINTBUTTON @"　最大值　",nINT:1
INPUT
IF RESULT <= (nINT:2-1) || RESULT > nINT:1
    PRINTW 您輸入了無效值，現在返回。
ELSE
    RESULT:94 = RESULT
    RESULT:91 = 1
ENDIF

;批量數值編輯
@EDIT_GROUP(myTITTLE,)
#DIMS myTITTLE
#DIM GROUPint,3
VARSET GROUPint,0
$LOOP_GROUP
CLEARLINE 1
DRAWLINE
SIF GROUPint:1 != 4
    PRINTFORML 現在編輯對象%myTITTLE%
IF GROUPint:1 == 0
    PRINTFORML 編輯起始值[0~99999](負值返回)
ELSEIF GROUPint:1 == 1
    PRINTFORML 現在起始值 ({RESULT:92})
    PRINTFORML 編輯終點值[0~99999](負值返回)
ENDIF
PRINTLC [-9]返回
IF GROUPint:1 == 0
    PRINTLC [-1]全部修改(無空值)
    PRINTLC [-2]全部修改(含空值)
ENDIF
IF RESULT:90 == 1
    PRINTLC [-3]全部修改(無空值、無負面值)
    PRINTLC [-4]全部修改(含空值、無負面值)
ENDIF
INPUT
IF RESULT < -8 || RESULT > 99999
    RESULT:91 = 4
    RETURN 0
ELSEIF RESULT == -1 || RESULT == -2 || RESULT == -3 || RESULT == -4
    SIF RESULT == -1 || RESULT == -3
        RESULT:91 = 1
    SIF RESULT == -2 || RESULT == -4
        RESULT:91 = 2
    SIF RESULT == -3 || RESULT == -4
        RESULT:90 = 2
    GROUPint:1 = 4
    GOTO LOOP_GROUP2
ELSE
    GROUPint:1 ++
    IF GROUPint:1 == 1
         RESULT:92= RESULT
         GOTO LOOP_GROUP
    ELSEIF GROUPint:1 == 2
         RESULT:93 = RESULT
         GOTO LOOP_GROUP2
    ENDIF
ENDIF
$LOOP_GROUP2
CLEARLINE 1
DRAWLINE
IF GROUPint:1 == 2
    PRINTFORML 現在編輯對象%myTITTLE%
    PRINTFORML 現在起始值 ({RESULT:92})，現在終點值 ({RESULT:93})
    PRINTFORML 欲修改結果[-99998~999999]（無効数値則取消）
ELSEIF GROUPint:1 == 4
    PRINTFORML 現在編輯對象%myTITTLE%全部\@(RESULT:90 == 2) ? (不含空白值) # (含空白值)\@
    PRINTFORML 欲修改結果[-99999~9999999]（無効数値則取消）
ENDIF
PRINTFORM %" " * 6 %
PRINTBUTTON "　返回　",-10000
SIF GROUPint:1 != 4
    PRINTBUTTON \@(GROUPint:2 == 0) ? 　× 批量編輯(含空白值) # 　○ 批量編輯(含空白值)\@,-100001
PRINTL
PRINTLC [0]　　[1]　　[5]　　[10]　　[99]　　[500]　　[999]　　[9999]　　
INPUT
IF RESULT == -100001
    GROUPint:2 ++
    IF GROUPint:2 == 2
        GROUPint:2 = 0
        RESULT:91 = 0
    ENDIF
    GOTO LOOP_GROUP2
ELSEIF RESULT < -99999 || RESULT > 9999999
    RESULT:91 = 4
    RETURN 0
ELSE
    IF GROUPint:1 == 4
        RESULT:94 = RESULT
    ELSEIF GROUPint:2 == 1
        RESULT:91 = 3
        RESULT:94 = RESULT
    ELSEIF GROUPint:1 == 2
        RESULT:91 = 0
        RESULT:94 = RESULT
    ENDIF
    RETURN 0
ENDIF
RETURN 0

;儲存刪除點
@GET_CLINE(lineLOG:0)
#FUNCTION
#DIM lineLOG,2
SIF lineLOG:0 != 1
	lineLOG:1 = LINECOUNT
RETURNF lineLOG:1

;現在頁數
@MY_PAGE(myPAGE:1,myPAGE:2)
#FUNCTION
#DIM myPAGE,3
IF myPAGE:2 == -1
	RETURNF myPAGE:0
ELSEIF myPAGE:2 == -2
	myPAGE:0 = myPAGE:1
	RETURNF myPAGE:0
ELSEIF myPAGE:1 == 0
	myPAGE:0 = 0
ELSE
	myPAGE:0 += myPAGE:1
	IF myPAGE:0 < 0 && myPAGE:0 == myPAGE:1
		myPAGE:0 = myPAGE:2
	ELSEIF myPAGE:0 < 0 && myPAGE:0 > myPAGE:1
		myPAGE:0 = 0
	ELSEIF myPAGE:0 > myPAGE:2 && myPAGE:0 == (myPAGE:2 + myPAGE:1)
		myPAGE:0 = 0
	ELSEIF myPAGE:0 > myPAGE:2 && myPAGE:0 >= myPAGE:2
		myPAGE:0 = myPAGE:2
	ENDIF
ENDIF
RETURNF myPAGE:0


;獲得頁數
@GET_PAGE(myMODE,cCOUNT,NEWitem,NEWitem:1,NEWitem:2,NEWitem:3)
#FUNCTION
#DIM myMODE
#DIM NEWitem,10
#DIM cCOUNT
NEWitem:9 = NEWitem:myMODE / cCOUNT -1
SIF (NEWitem:myMODE % cCOUNT) != 0
  	 NEWitem:9 ++
SIF (NEWitem:myMODE - cCOUNT) <= 0
   	NEWitem:9 = 0
RETURNF NEWitem:9

;名稱盡可能對齊， 計算預留空白數>
@GET_INTname(nameFLAG,oldNAME)
#FUNCTION
#DIM nameFLAG
#DIM INTform
#DIM sCOUNT,3
#DIM newNAME
#DIMS oldNAME
#DIMS nowNAME,3
VARSET sCOUNT,0

nowNAME:1 = %TOFULL(oldNAME)%
newNAME = STRLENS(nowNAME:1)
STRLENS oldNAME
IF newNAME != RESULT
    IF (newNAME / RESULT) == 2
        INTform = newNAME / 2
        nowNAME:2 = % "？" * INTform%
        newNAME= 0
        SIF nowNAME:1 == nowNAME:2
            newNAME = INTform
    ELSE
        newNAME = newNAME - RESULT
        $LOOP_STRFIND
            STRFIND NAME:COUNT," ",sCOUNT:1
            IF RESULT > -1
                sCOUNT:2 ++
                sCOUNT:1 = RESULT+1
                GOTO LOOP_STRFIND
            ENDIF
        newNAME = newNAME - sCOUNT:2
    ENDIF
ELSEIF newNAME == RESULT
        newNAME = 0
ENDIF
RETURNF newNAME

;修改顯示模式
@NXP_MODE(myMODE,myMODE:1,myMODE:2)
#FUNCTION
#DIM myMODE,4
IF myMODE == 0
	IF myMODE:3 != myMODE:2
		myMODE:3 = myMODE:2
	ELSEIF myMODE:3 == myMODE:2
		myMODE:3 = 0
	ENDIF
ENDIF
RETURNF myMODE:3

;修改顯示數
@GET_check
DRAWLINE
PRINTFORML 修改每一頁顯示參數量，建議數值在100至250之間(依字體大小決定)
PRINTFORML 當前一頁顯示參數為 {RESULT:81}，請輸入數值 (負數則取消)
PRINTL
PRINTLC [100]   [150]   [200]   [250]
PRINTL
PRINTLC [-99] 取消
INPUT
SIF RESULT <= 0
    RETURN 0
RESULT:81 = RESULT

;計算行字數
@GET_LINEint(LINEmode,getINT,getNAME)
#FUNCTION
#DIM LINEmode
#DIM getINT,4
#DIMS getNAME
VARSET getINT,0,1,3
getINT:2 = LINECOUNT
getINT:3 = 100
REPEAT getINT:3
    PRINTFORM -
    IF LINECOUNT == getINT:2
        getINT:1 ++
    ELSEIF LINECOUNT != getINT:2
        CONTINUE
    ENDIF
REND
PRINTL
CLEARLINE LINECOUNT-GET_CLINE(1)
getINT:1 -= getINT
RETURNF getINT:1

;顯示字串的(換行試算)
@NXP_PRINTlist(txtPRINT:10,intPRINT)
#DIM  intPRINT,3
#DIMS txtPRINT,11
VARSET intPRINT,0,1,2
VARSET txtPRINT,"",0,10
intPRINT:1 = intPRINT+8
intPRINT:2 = STRLENS(TOFULL(txtPRINT:10))
IF (intPRINT:2 - intPRINT:1) > 0
    FOR RESULT,0,10
        txtPRINT:RESULT = %SUBSTRING(txtPRINT:10,(intPRINT:1*RESULT),intPRINT:1)%
        SIF STRLENS(txtPRINT:RESULT) != 0
            PRINTFORML %" "*6%%txtPRINT:RESULT%
    NEXT
ELSE
    PRINTFORML %" "*6%%txtPRINT:10%
ENDIF

;--------------------------------------------------
;顯示與通用按鈕
;--------------------------------------------------
;標題插件
@NXP_title(NEWitem:0,nowTITLE,NEWitem:1,NEWitem:2,NEWitem:3,NEWitem:4)
#DIM NEWitem,5
#DIMS nowTITLE
ALIGNMENT CENTER
IF NEWitem:0 == 1
    IF NEWitem:4 == 0
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-有效)(合計{NEWitem:2,3}筆)
    ELSEIF NEWitem:4 == 1
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-展開)(合計{NEWitem:2,3}筆)
    ELSEIF NEWitem:4 == 2
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-全部)(合計{NEWitem:1,3}筆)
    ELSEIF NEWitem:4 == 3
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-不為0)(合計{NEWitem:3,3}筆)
    ENDIF
ELSEIF NEWitem:0 == 2
    IF NEWitem:4 != 3
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-全部)(合計{NEWitem:0,3}筆)
    ELSEIF NEWitem:4 == 3
        PRINTFORM 當前為 %TOFULL(nowTITLE)% 頁面 (顯示模式-不為0)(合計{NEWitem:1,3}筆)
    ENDIF
ENDIF
PRINTL
ALIGNMENT LEFT

;標題插件2
@NXP_CHARAtitle(nowTYPE,nowTITLE,nowTARGET)
#DIM nowTYPE
#DIM nowTARGET
#DIMS nowTITLE
ALIGNMENT CENTER
PRINTFORML %nowTITLE%
ALIGNMENT LEFT
;DRAWLINE

;角色插件
@NXP_BCHARAR(charaFLAG)
#DIM charaFLAG
ALIGNMENT CENTER
PRINTFORM \@(TARGET == 0) ? 主人 # 奴隸\@「%NAME%/%CALLNAME%」選擇中
PRINTBUTTON @" [對象變更] ",29001
PRINTBUTTON @" [個人情報] ",29002
IF charaFLAG == 1
    PRINTBUTTON @" [修改名稱] ",29003
    PRINTBUTTON @" [主人交換] ",29009
ENDIF
PRINTL
ALIGNMENT LEFT
DRAWLINE

;模式插件
@NXP_BMODE(bmodeFLAG,bmodeFLAG:1)
#DIM bmodeFLAG,3
#DIM sFLAG,4
VARSET sFLAG,0
SIF bmodeFLAG:1 == 1
	sFLAG:1 = !sFLAG:1
SIF bmodeFLAG:1 == 2
	sFLAG:2 = !sFLAG:2
SIF bmodeFLAG:1 == 3
	sFLAG:3 = !sFLAG:3
ALIGNMENT CENTER
SIF bmodeFLAG == 1
    PRINTBUTTON \@(!sFLAG:1) ? 　× 一次展開/關閉 # 　○ 一次展開/關閉\@,21202
SIF bmodeFLAG == 1
    PRINTBUTTON \@(!sFLAG:2) ? 　× 顯示全部/有效 # 　○ 顯示全部/有效\@,21203
PRINTBUTTON \@(!sFLAG:3) ? 　× 僅顯示不為0項目 # 　○ 僅顯示不為0項目\@,21204
PRINTBUTTON @"　△ 修改顯示數(目前{RESULT:81})",21209
PRINTL
ALIGNMENT LEFT
DRAWLINE
DRAWLINEFORM =

;頁數插件
@NXP_BPAGE(myPAGE:1,myPAGE)
#DIM myPAGE,2
#DIMS PAGEname
PAGEname = ＜%TOSTR(myPAGE:1+1)%/%TOSTR(myPAGE+1)%＞
ALIGNMENT CENTER
PRINTBUTTON PAGEname,21109
PRINTL
ALIGNMENT LEFT

;頁數跳躍====
@NXP_GOpage(GOpage:1,GOpage)
#DIM GOpage,2
PRINTFORML 現在頁數{GOpage:1+1},最大頁數{GOpage+1}
PRINTFORM 飛躍至指定頁數 > ,請不超越最大頁數，0以下返回)
PRINTBUTTON @"　[返回]",-1
PRINTL
$LOOP_INPUT
INPUT
IF RESULT < 1
    RETURN
ELSEIF RESULT > (GOpage+1)
    PRINTFORML 再試一次，請不超越最大頁數
    GOTO LOOP_INPUT
ELSE
    GOpage:1 = MY_PAGE(RESULT-1,-2)
ENDIF


;動作按鈕
@NXP_BUSER(myPAGE,BUSERflag)
#DIM myPAGE
#DIM BUSERflag
ALIGNMENT CENTER
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [21101]上一頁\@
PRINTLC [10000]返回
PRINTFORMLC \@(myPAGE == 0) ? %" " * 17% # [21102]下一頁\@
PRINTL
PRINTFORMLC \@(9 > myPAGE) ? %" " * 17% # [21103]上十頁\@
SIF BUSERflag == 1
    PRINTLC [19999]範圍修改
PRINTLC [20009]检索
PRINTFORMLC \@(9 > myPAGE) ? %" " * 17% # [21104]下十頁\@
PRINTL
ALIGNMENT LEFT

;按鈕結果(20000-30000)
@NXP_BRESULT(resultFLAG,BREint,BREtxt,myPAGE:1,myPAGE,myMODE)
#DIM myPAGE,2
#DIM myMODE
#DIM BREint
#DIM resultFLAG
#DIMS BREtxt
SELECTCASE BREint
    CASE 20009
        CALL SEARCHFOR(resultFLAG,BREtxt)
    CASE 21101
        myPAGE:1 = MY_PAGE(-1,myPAGE)
    CASE 21102
        myPAGE:1 = MY_PAGE(1,myPAGE)
    CASE 21103
        myPAGE:1 = MY_PAGE(-10,myPAGE)
    CASE 21104
        myPAGE:1 = MY_PAGE(10,myPAGE)
    CASE 21109
        CALL NXP_GOpage(myPAGE:1,myPAGE)
    CASE 21202
		myMODE = NXP_MODE(0,myMODE,1)
        myPAGE:1 = MY_PAGE(0,0)
    CASE 21203
		myMODE = NXP_MODE(0,myMODE,2)
        myPAGE:1 = MY_PAGE(0,0)
    CASE 21204
		myMODE = NXP_MODE(0,myMODE,3)
        myPAGE:1 = MY_PAGE(0,0)
    CASE 21209
        CALL GET_check
        myPAGE:1 = MY_PAGE(0,0)
    CASE 29001
        CALL NEXT_CHARA("sCHARA",myMODE,myPAGE:1)
    CASE 29002
        CALL DEBUG_CHARADATA(TARGET)
    CASE 29003
        CALL EDIT_CHARAname(TARGET)
    CASE 29009
        CALL EDIT_MASTERswitch("MASTERswitch",myMODE,myPAGE:1)
    CASEELSE
        RETURN 0
ENDSELECT
RETURN

;--------------------------------------------------
;其他顯示
;--------------------------------------------------
@DEBUG_MAID_K
PRINTDATAL
	DATAFORM 　我是DEBUG女僕喔❤
	DATAFORM 　主人需要什麼服務嗎？
	DATAFORM 　主人...?
	DATAFORM 　主❤人❤
	DATAFORM 　。 。 。 . . . 　　　z Z z Z z　　　 . . . ！　沒有，我一點也不累！
	DATAFORM 　诶嘿　　☆（ゝω●）
	DATAFORM 　沒有在花時間刷新資訊吧...？
   	DATAFORM 　有任何錯誤可以在深淵、巴哈進行回報喔❤
   	DATAFORM 　這是一個功能強大，且不限定你現在遊玩的遊戲使用的DEBUG喔。
   	DATAFORM 　主頁面太亂時，記得善用活頁把不常用的選項作收納喔。
   	DATAFORM 　進行修改如果太過撩亂，試著活用顯示模式的修改喔。
   	DATAFORM 　請注意！修改日期有一定的風險，修改結果在退出後啟用，判定模式為日期變動。
   	DATAFORM 　角色全恢復的實際效果仍會因不同的遊戲有所差異，如果有沒改到的部分要自己去修改MAXBASE喔。
   	DATAFORM 　請不要過度依賴DEBUG，雖然可以增加遊戲樂趣，也可能會降低遊戲樂趣喔❤
   	DATAFORM 　"其他項目"下的標籤目前可以點但沒有用，所以如果出錯也不用回報喔❤
   	DATAFORM 　還有許多想加的功能沒加，是否更新還是看心情。但是有BUG會優先改唷❤
   	DATAFORM 　DEBUG只是工具，有些修改可以接近理想但無法接近完美喔❤
   	DATAFORM 　角色資訊在不同的遊戲下標籤、涵式會有所差別，所以DEBUG內的資訊僅列出比較重要的而已喔。
   	DATAFORM 　"主人變更"僅是個娛樂性質偏高的功能，會連CFLAG都交換，可能會導致部分事件出錯唷。
   	DATAFORM 　遊戲要玩，身體也要照顧喔❤
   	DATAFORM 　DEBUG專用的存檔是自動存檔，你只能做讀取而已唷。
   	DATAFORM 　DEBUG專用的存檔分別是991.2.3，分別是修改前(991)、上次修改、上上次修改(992.3輪流存)。
   	DATAFORM 　修改後發生錯誤可以善用DEBUG存檔喔。看是從DEBUG做讀檔，或是更名後從正規地方讀取都可以唷。
	DATAFORM 　不要修改太入迷，記得遊戲也要玩唷❤
ENDDATA